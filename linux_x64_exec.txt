linux/x64/exec


msfvenom.bat -p linux/x64/exec CMD="/bin/uname -a" â€“f c

gcc -fno-stack-protector -z execstack a.c


// gcc -fno-stack-protector -z execstack a.c
// msfvenom.bat -p linux/x64/exec CMD="/bin/uname -a" -f c

#include<stdio.h>
#include<string.h>

unsigned char code[] =
		"\x6a\x3b\x58\x99\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68\x00\x53"
		"\x48\x89\xe7\x68\x2d\x63\x00\x00\x48\x89\xe6\x52\xe8\x0e\x00"
		"\x00\x00\x2f\x62\x69\x6e\x2f\x75\x6e\x61\x6d\x65\x20\x2d\x61"
		"\x00\x56\x57\x48\x89\xe6\x0f\x05";


main()
{

    printf("Shellcode Length:  %d\n", strlen(code));

    int (*ret)() = (int(*)())code;

    ret();

}
















